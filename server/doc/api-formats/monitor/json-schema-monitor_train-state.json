{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "monitor_train-state.schema.json",
  "title": "train-state",
  "description": "state of a train",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "minLength": 1
    },
    "grabbed": {
      "type": "boolean"
    },
    "orientation": {
      "type": "string",
      "minLength": 0
    },
    "direction": {
      "type": "string",
      "minLength": 0
    },
    "speed_step": {
      "type": "number"
    },
    "detected_kmh_speed": {
      "type": "number",
      "$comment": "Some trains don't report their km/h speed; in that case the value is 0"
    },
    "route_id": {
      "type": "string",
      "$comment": "empty string if no route is granted to this train. Otherwise route id.",
      "minLength": 0
    },
    "on_track": {
      "type": "boolean"
    },
    "occupied_segments": {
      "type": "array",
      "$comment": "occupied_segments is only included if on_track is true.",
      "items": {
        "type": "string"
      }
    },
    "occupied_blocks": {
      "type": "array",
      "$comment": "occupied_blocks is only included if on_track is true.",
      "items": {
        "type": "string"
      }
    }, 
    "msg": {
      "type": "string",
      "description": "rejection/error message",
      "minLength": 1
    }
  },
  "oneOf": [
    {"required": ["id",
                  "grabbed",
                  "orientation",
                  "direction",
                  "speed_step",
                  "detected_kmh_speed",
                  "route_id",
                  "on_track"]},
    {"required": ["msg"]}
  ]
}